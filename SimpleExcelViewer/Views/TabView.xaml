<UserControl
	x:Class="SimpleExcelViewer.Views.TabView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:base="RW.Base.WPF"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:dialogs="clr-namespace:SimpleExcelViewer.Views.Dialogs"
	xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
	xmlns:enums="clr-namespace:SimpleExcelViewer.Enums"
	xmlns:fastwpfgrid="clr-namespace:FastWpfGrid;assembly=FastWpfGrid"
	xmlns:local="clr-namespace:SimpleExcelViewer.Views"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:vms="clr-namespace:SimpleExcelViewer.ViewModelServices"
	xmlns:wpf="RW.Common.WPF"
	d:Background="White"
	d:DataContext="{d:DesignInstance Type=local:TabViewModel}"
	d:Height="450"
	d:Width="800"
	DataContext="{base:DISource Type=local:TabViewModel}"
	mc:Ignorable="d">

	<dxmvvm:Interaction.Behaviors>
		<base:DispatcherServiceEx/>
		<base:TypedUIObjectService Name="UserControlService"/>
		<vms:MessageBoxServiceEx/>

		<vms:DialogService x:Name="ManageColumnsDialogService" ContentType="{x:Type dialogs:ManageColumnsDialog}"/>

	</dxmvvm:Interaction.Behaviors>

	<Grid>
		<Border d:Visibility="Visible" Visibility="{Binding Parameter.IsLoading, Converter={StaticResource Boolean2VisibilityReConverter}}">
			<DockPanel>

				<Border Padding="4" DockPanel.Dock="Top">
					<DockPanel>
						<wpf:SpacingStackPanel HorizontalSpacing="4" ItemVerticalAlignment="Center" Orientation="Horizontal">
							<Button Command="{Binding ManageColumnsCommand}" Content="Manage Columns"/>
							<wpf:EnumBindingComboBox Width="200" EnumType="{x:Type enums:ColumnHeaderType}" SelectedEnum="{Binding Parameter.ColumnHeaderType}"/>
							<Button Command="{Binding AutoColumnsWidthCommand}" Content="Auto Columns Width"/>
							<CheckBox Content="Transpose" IsChecked="{Binding Parameter.IsTransposed, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
							<!--<CheckBox Content="Show Column Index" IsChecked="{Binding Parameter.IsTransposed, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>-->
						</wpf:SpacingStackPanel>

						<Border HorizontalAlignment="Right" VerticalAlignment="Center">
							<TextBlock wpf:ToolTipExtension.FastToolTip="True" Text="{Binding Parameter.TableModel.SelectionRect, Converter={StaticResource SelectionRectDisplayConverter}}" Visibility="{Binding Parameter.TableModel.SelectionRect, Converter={StaticResource Object2VisibilityConverter}}">
								<TextBlock.ToolTip>
									<StackPanel>
										<TextBlock Text="Selection Rect"/>
										<TextBlock>
											<Run Text="From: "/><Run Text="{Binding Parameter.TableModel.SelectionRect.RectFrom, Converter={StaticResource SimpleCellAddressDisplayConverter}, Mode=OneWay}"/>
										</TextBlock>
										<TextBlock>
											<Run Text="To: "/><Run Text="{Binding Parameter.TableModel.SelectionRect.RectTo, Converter={StaticResource SimpleCellAddressDisplayConverter}, Mode=OneWay}"/>
										</TextBlock>
									</StackPanel>
								</TextBlock.ToolTip>
							</TextBlock>
						</Border>

					</DockPanel>
				</Border>

				<Border
					Height="1"
					HorizontalAlignment="Stretch"
					Panel.ZIndex="10"
					Background="#D3D3D3"
					DockPanel.Dock="Top"
					RenderOptions.EdgeMode="Aliased"
					SnapsToDevicePixels="True"
					UseLayoutRounding="True"/>

				<Border Visibility="Visible">
					<fastwpfgrid:FastGridControl x:Name="MainFastGridControl"
						Margin="0,0,0,-2"
						CellPaddingHorizontal="6"
						HeaderWidth="80"
						IsReadOnly="True"
						Model="{Binding Parameter.TableModel}"
						UseClearType="True"/>
				</Border>

			</DockPanel>
		</Border>

		<Grid d:Visibility="Collapsed" Visibility="{Binding Parameter.IsLoading, Converter={StaticResource Boolean2VisibilityConverter}}">
			<Border HorizontalAlignment="Center" VerticalAlignment="Center">
				<StackPanel>
					<Border Margin="10,0" Padding="8" Background="#d0d0d0">
						<StackPanel Orientation="Vertical">
							<ProgressBar
								Height="20"
								MinWidth="250"
								Minimum="0"
								Maximum="1"
								wpf:ProgressBarExtension.Progress="{Binding Parameter.StatusReport.Progress}"/>
							<Border Height="8"/>
							<TextBlock d:Text="Loading" Text="{Binding Parameter.StatusReport.Status}" TextAlignment="Center"/>

							<!--<Border
								Height="1"
								Margin="0,8,0,2"
								HorizontalAlignment="Stretch"
								Background="Gray"/>

							<Grid>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="8"/>
									<ColumnDefinition Width="auto"/>
								</Grid.ColumnDefinitions>
								<Button Margin="0,4,0,0" Content="Stop And Show"/>
								<Button Grid.Column="2" Margin="0,4,0,0" Content="Cancel"/>
							</Grid>-->

							<Border
								Height="1"
								Margin="-8,8,-8,2"
								HorizontalAlignment="Stretch"
								Background="Gray"/>

							<Expander Margin="0,4,0,0" Header="More Actions">
								<StackPanel>
									<Button Margin="0,4,0,0" Command="{Binding InterruptAndShowCommand}" Content="Interrupt &amp; Show"/>
									<Button Margin="0,4,0,0" Command="{Binding CancelLoadingCommand}" Content="Cancel Loading"/>
								</StackPanel>
							</Expander>

						</StackPanel>
					</Border>

					<!--<Expander Margin="10,4" Header="More Actions">
						<StackPanel>
							<Button Margin="0,4,0,0" Content="Stop And Show"/>
							<Button Margin="0,4,0,0" Content="Cancel"/>
						</StackPanel>
					</Expander>-->
				</StackPanel>

			</Border>
		</Grid>

	</Grid>

</UserControl>
